# MindCoach AI — 上线待办清单

> **维护规则**：本文件是多 Agent 协作的唯一任务来源。
> 每项任务有唯一 ID，状态标记规则见下方。
>
> | 标记 | 含义 |
> |------|------|
> | `[ ]` | 未认领 — 任何 Agent 可认领 |
> | `[🔒 <agent>]` | 已认领 — `<agent>` 正在开发（如 `cursor-1`、`codex`、`gemini`） |
> | `[✅]` | 已完成并合并 main |
> | `[⛔]` | 已取消或不再需要 |
>
> **认领流程**：修改本文件 → `git add todo.md && git commit -m "claim: T-xxx by <agent>" && git push`
> **完成流程**：改为 `[✅]` → commit + push（随功能代码一起）

---

## 一、前端用户端 — 生产化完善

### 1.1 用户认证 & Onboarding

- [🔒 codex-0220a] **T-101** 用户端真实密码注册/登录流程（后端新增 `/api/auth/login` + JWT/session）
- [✅] **T-102** Onboarding 引导流程：注册后引导填写基础量表（PHQ-9、GAD-7），完成分流
- [🔒 codex-0220b] **T-103** 隐私政策页 `/privacy` + 服务条款页 `/terms`（中英文）
- [ ] **T-104** 忘记密码 / 重置密码流程

### 1.2 页面体验增强

- [✅] **T-111** 全局 Toast 通知组件（替代 alert，成功/错误/警告三种）
- [ ] **T-112** 全局 ErrorBoundary 组件 + 友好的错误页面（500/网络错误）
- [ ] **T-113** 404 页面（温馨风格，引导回首页）
- [ ] **T-114** 页面切换过渡动画全局统一（Framer Motion AnimatePresence）
- [ ] **T-115** 表单统一校验反馈（邮箱格式、必填、长度限制等）
- [ ] **T-116** 骨架屏 Skeleton 组件（替代纯 spinner，用于列表/卡片加载）

### 1.3 AI 教练增强

- [ ] **T-121** 补全 5 种咨询风格（深度探索、正念引导、行动教练 — 目前仅 2 种）
- [ ] **T-122** 教练对话打字机效果（逐字显示，模拟 Streaming）
- [ ] **T-123** 会话历史列表页（查看过往对话摘要）
- [ ] **T-124** 教练页面响应式优化（移动端键盘弹出时输入框自适应）

### 1.4 量表 & 测试增强

- [ ] **T-131** 量表结果 paywall 门控（未订阅用户模糊显示结果 + 订阅引导）
- [ ] **T-132** SCL-90 长量表分页答题 UX 优化（进度保存 + 分组标题）
- [ ] **T-133** 测试配对/互测功能（生成邀请链接 → 好友完成 → 匹配报告）
- [ ] **T-134** 量表定期重测提醒逻辑（对接后端 reassessment schedule）

### 1.5 疗愈工具增强

- [✅] **T-141** 白噪音真实音频文件集成（至少 5 种：雨声、森林、海浪、篝火、咖啡厅）
- [ ] **T-142** 冥想引导音频文件集成（至少 3 段引导音频）
- [✅] **T-143** 呼吸练习增加更多模式（box breathing 4-4-4-4、放松呼吸 5-5）
- [ ] **T-144** 工具使用统计面板（本周使用次数、累计时长）

### 1.6 社交 & 增长

- [ ] **T-151** 分享卡片适配多种测试类型（MBTI 特定设计、Big Five 雷达图风格）
- [ ] **T-152** Open Graph / Twitter Card 元数据（分享链接预览）
- [ ] **T-153** PWA manifest + Service Worker（离线缓存危机热线 + 安装到桌面）

### 1.7 无障碍 & 国际化

- [ ] **T-161** ARIA 无障碍审查（所有交互元素标注 role/label，键盘导航）
- [ ] **T-162** 暗色模式（CSS 变量切换 + 用户偏好持久化）
- [ ] **T-163** 语言切换后动态更新 `<html lang>`、`document.title`

---

## 二、后端 — 生产化加固

### 2.1 用户认证

- [ ] **T-201** 用户端 JWT 认证体系（注册/登录/刷新 token，独立于 admin session）
- [ ] **T-202** 邮箱验证流程（注册后发送验证链接）
- [ ] **T-203** API 速率限制（per-user / per-IP，防滥用）

### 2.2 支付集成

- [ ] **T-211** Stripe 支付集成（checkout session → webhook → 订阅激活）
- [ ] **T-212** 支付宝/微信支付集成（国内用户）
- [ ] **T-213** 订阅到期自动降级逻辑 + 续费提醒

### 2.3 数据 & 安全

- [ ] **T-221** 数据库迁移工具集成（Alembic / 自定义 migration）
- [ ] **T-222** API 请求/响应日志（脱敏后存储，用于审计）
- [ ] **T-223** 敏感数据字段加密存储（量表结果、对话记录 AES-256）

### 2.4 AI 教练后端

- [ ] **T-231** 补全 3 种咨询风格 Prompt Pack（深度探索、正念引导、行动教练）
- [ ] **T-232** 教练会话历史 API（列表 + 单条摘要）
- [ ] **T-233** OpenAI/Claude streaming 响应支持（SSE endpoint）

### 2.5 工具资源

- [ ] **T-241** 白噪音音频文件托管方案（对象存储 / CDN / 内嵌）
- [ ] **T-242** 冥想引导音频托管 + 元数据 API

---

## 三、测试 — 上线门槛

- [ ] **T-301** 前端用户端单元测试（Vitest — 至少覆盖 stores、api client、utils）
- [ ] **T-302** 前端组件测试（React Testing Library — 核心组件 Button/Card/Modal/CrisisBanner）
- [ ] **T-303** 前端 E2E 冒烟测试（Playwright — 注册→量表→结果→教练完整流程）
- [ ] **T-304** 后端安全测试补充（安全红线全覆盖回归测试）
- [ ] **T-305** 性能基准测试（首屏加载 <2s、教练响应 <3s、量表提交 <1s）

---

## 四、DevOps & 部署

- [ ] **T-401** Dockerfile（后端 + 前端构建 + Nginx 静态服务）
- [ ] **T-402** docker-compose.yml（一键启动全栈：backend + frontend + db）
- [ ] **T-403** CI pipeline（GitHub Actions：lint → test → build → deploy）
- [ ] **T-404** 环境变量文档（`.env.example` + 说明所有必需变量）
- [ ] **T-405** 生产部署指南文档（`docs/deployment.md`）

---

## 五、Admin 管理端增强

- [ ] **T-501** Admin Observability 面板 UI（模型调用统计、延迟分布、错误率）
- [ ] **T-502** Admin Prompt 管理面板 UI（查看/切换 Prompt Pack）
- [ ] **T-503** Admin 用户管理面板（用户列表、通道状态、手动分流调整）
- [ ] **T-504** Admin 数据合规操作面板（触发数据导出/删除）

---

## 优先级参考

| 批次 | 任务 ID | 说明 |
|------|---------|------|
| **P0 上线必须** | T-101, T-102, T-103, T-111, T-112, T-113, T-201, T-301, T-401, T-402 | 认证、基础体验、测试、部署 |
| **P0 安全红线** | T-203, T-221, T-223, T-304 | 安全加固 |
| **P1 体验优化** | T-114~T-116, T-121~T-124, T-131~T-134, T-141~T-144, T-161~T-163 | 打磨 UX |
| **P1 增长** | T-151~T-153, T-211~T-213 | 社交分享、支付 |
| **P2 管理** | T-501~T-504 | Admin 增强 |
